{"version":3,"sources":["../../src/__tests__/index.test.js"],"names":["babel","babelIpc","logger","beforeEach","set","__filename","log","it","source","transform","filenameRelative","plugins","expect","messages","toMatchSnapshot","describe","code"],"mappings":"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","file":"index.test.js","sourcesContent":["/**\n * Â© 2017 Liferay, Inc. <https://liferay.com>\n *\n * SPDX-License-Identifier: LGPL-3.0-or-later\n */\n\nimport * as babel from 'babel-core';\nimport * as babelIpc from 'liferay-npm-build-tools-common/lib/babel-ipc';\nimport PluginLogger from 'liferay-npm-build-tools-common/lib/plugin-logger';\nimport plugin from '../index';\n\nlet logger;\n\nbeforeEach(() => {\n\tbabelIpc.set(__filename, {\n\t\tlog: (logger = new PluginLogger()),\n\t});\n});\n\nit('logs results correctly', () => {\n\tconst source = `\n\trequire('a-package.js');\n\trequire('./a-module.js');\n\t`;\n\n\tbabel.transform(source, {\n\t\tfilenameRelative: __filename,\n\t\tplugins: [plugin],\n\t});\n\n\texpect(logger.messages).toMatchSnapshot();\n});\n\ndescribe('when requiring package default modules', () => {\n\tit('keeps trailing \".js\" from package names', () => {\n\t\tconst source = `\n\t\trequire('a-package.js')\n\t\t`;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n\n\tit('keeps trailing \".js\" from scoped package names', () => {\n\t\tconst source = `\n\t\trequire('@some-scope/a-package.js')\n\t\t`;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n});\n\ndescribe('when requiring local modules', () => {\n\tit('removes trailing \".js\" from module names', () => {\n\t\tconst source = `\n\t    require('./a-module.js')\n\t    `;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n\n\tit('removes trailing \"/\" from module names', () => {\n\t\tconst source = `\n\t\trequire('./a-module/')\n\t    `;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n\n\tit('only removes trailing \"/\" from module names ending in \".js\"', () => {\n\t\tconst source = `\n\t\trequire('./a-module.js/')\n\t    `;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n});\n\ndescribe('when requiring external modules', () => {\n\tit('removes trailing \".js\" from module names', () => {\n\t\tconst source = `\n\t\trequire('a-package/a-module.js')\n\t    `;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n\n\tit('removes trailing \"/\" from module names', () => {\n\t\tconst source = `\n\t\trequire('a-package/a-module/')\n\t    `;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n\n\tit('only removes trailing \"/\" from module names ending in \".js\"', () => {\n\t\tconst source = `\n\t\trequire('a-package/a-module.js/')\n\t\t`;\n\n\t\tconst {code} = babel.transform(source, {\n\t\t\tfilenameRelative: __filename,\n\t\t\tplugins: [plugin],\n\t\t});\n\n\t\texpect(code).toMatchSnapshot();\n\t});\n});\n"]}