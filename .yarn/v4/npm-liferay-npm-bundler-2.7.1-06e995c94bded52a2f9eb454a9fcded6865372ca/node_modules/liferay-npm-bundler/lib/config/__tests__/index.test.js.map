{"version":3,"sources":["../../../src/config/__tests__/index.test.js"],"names":["cfg","require","savedCwd","process","cwd","beforeEach","chdir","join","__dirname","reloadConfig","afterEach","describe","it","expect","jar","getRequireJsExtender","toBe","getWebContextPath","isCreateJar","toBeFalsy","toBeTruthy","getOutputDir","toEqual","versions","getVersionsInfo","myVersion","version","Object","keys","length","config","babel","getConfig","id","name","dir","pkg","bundler","getExclusions","plugins","getPlugins","run","globalCfg","getGlobalConfig","imports","toBeDefined","expectedImports","map","v","anOsgiModuleImports","d3","react","toMatchObject","frontendJsWebImports","frontendJsNodeShimsImports","assert","buffer","events","punycode","setimmediate","string_decoder","url","util","isDumpReport"],"mappings":"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","file":"index.test.js","sourcesContent":["/**\n * © 2017 Liferay, Inc. <https://liferay.com>\n *\n * SPDX-License-Identifier: LGPL-3.0-or-later\n */\n\nimport path from 'path';\n\nconst cfg = require('..');\n\nconst savedCwd = process.cwd();\n\nbeforeEach(() => {\n\tprocess.chdir(path.join(__dirname, '__fixtures__', 'config', 'default'));\n\tcfg.reloadConfig();\n});\n\nafterEach(() => {\n\tprocess.chdir(savedCwd);\n});\n\ndescribe('deprecated config', () => {\n\tdescribe('.npmbundlerrc', () => {\n\t\tit('create-jar/auto-deploy-portlet', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(__dirname, '__fixtures__', 'config', 'legacy-test-1')\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\texpect(cfg.jar.getRequireJsExtender()).toBe(false);\n\t\t});\n\n\t\tit('create-jar/web-context-path', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(__dirname, '__fixtures__', 'config', 'legacy-test-1')\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\texpect(cfg.jar.getWebContextPath()).toBe('/my-portlet');\n\t\t});\n\t});\n\n\tdescribe('package.json', () => {\n\t\tit('osgi/web-context-path', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(__dirname, '__fixtures__', 'config', 'legacy-test-2')\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\texpect(cfg.jar.getWebContextPath()).toBe('/my-portlet');\n\t\t});\n\t});\n});\n\ndescribe('global config', () => {\n\tdescribe('isCreateJar()', () => {\n\t\tit('returns false when config missing', () => {\n\t\t\texpect(cfg.isCreateJar()).toBeFalsy();\n\t\t});\n\n\t\tit('works with boolean config', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(\n\t\t\t\t\t__dirname,\n\t\t\t\t\t'__fixtures__',\n\t\t\t\t\t'config',\n\t\t\t\t\t'create-jar-bool'\n\t\t\t\t)\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\texpect(cfg.isCreateJar()).toBeTruthy();\n\t\t});\n\n\t\tit('works with Object config', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(__dirname, '__fixtures__', 'config', 'create-jar')\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\texpect(cfg.isCreateJar()).toBeTruthy();\n\t\t});\n\t});\n\n\tit('getOutputDir() works', () => {\n\t\texpect(cfg.getOutputDir()).toEqual('output-dir');\n\t});\n\n\tit('getVersionsInfo() works', () => {\n\t\tconst versions = cfg.getVersionsInfo();\n\t\tconst myVersion = require('../../../package.json').version;\n\n\t\texpect(Object.keys(versions).length).toEqual(9);\n\t\texpect(versions['liferay-npm-bundler']).toEqual(myVersion);\n\t\texpect(versions['liferay-npm-bundler-plugin-test-0']).toEqual('1.0.0');\n\t\texpect(versions['liferay-npm-bundler-plugin-test-1']).toEqual('1.0.1');\n\t\texpect(versions['liferay-npm-bundler-plugin-test-2']).toEqual('1.0.2');\n\t\texpect(versions['liferay-npm-bundler-plugin-test-3']).toEqual('1.0.3');\n\t\texpect(versions['liferay-npm-bundler-plugin-test-4']).toEqual('1.0.4');\n\t\texpect(versions['liferay-npm-bundler-plugin-test-5']).toEqual('1.0.5');\n\t\texpect(versions['liferay-npm-bundler-plugin-test-6']).toEqual('1.0.6');\n\t\texpect(versions['liferay-npm-bundler-plugin-test-7']).toEqual('1.0.7');\n\t});\n});\n\ndescribe('babel config', () => {\n\tdescribe('getConfig()', () => {\n\t\tit('loads default config correctly', () => {\n\t\t\tconst config = cfg.babel.getConfig({\n\t\t\t\tid: 'package-star@1.0.0',\n\t\t\t\tname: 'package-star',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\n\t\t\texpect(config).toEqual({config: 'config-*'});\n\t\t});\n\n\t\tit('loads per-package config correctly when configured by id', () => {\n\t\t\tconst config = cfg.babel.getConfig({\n\t\t\t\tid: 'package@1.0.0',\n\t\t\t\tname: 'package',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\n\t\t\texpect(config).toEqual({config: 'config-package@1.0.0'});\n\t\t});\n\n\t\tit('loads per-package config correctly when configured by name', () => {\n\t\t\tconst config = cfg.babel.getConfig({\n\t\t\t\tid: 'package2@1.0.0',\n\t\t\t\tname: 'package2',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\n\t\t\texpect(config).toEqual({config: 'config-package2'});\n\t\t});\n\t});\n});\n\ndescribe('bundler config', () => {\n\tdescribe('getExclusions()', () => {\n\t\tit('works for unversioned packages', () => {\n\t\t\tconst pkg = {\n\t\t\t\tid: 'package-a@2.0.0',\n\t\t\t\tname: 'package-a',\n\t\t\t\tversion: '2.0.0',\n\t\t\t\tdir: '',\n\t\t\t};\n\n\t\t\texpect(cfg.bundler.getExclusions(pkg)).toEqual(['*']);\n\t\t});\n\n\t\tit('works for versioned packages', () => {\n\t\t\tconst pkg = {\n\t\t\t\tid: 'package-b@1.0.0',\n\t\t\t\tname: 'package-b',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t};\n\n\t\t\texpect(cfg.bundler.getExclusions(pkg)).toEqual([\n\t\t\t\t'**/*.js',\n\t\t\t\t'**/*.css',\n\t\t\t]);\n\t\t});\n\n\t\tit('returns the default exclusions for unconfigured packages', () => {\n\t\t\tconst pkg = {\n\t\t\t\tid: 'not-existent-package@1.0.0',\n\t\t\t\tname: 'not-existent-package',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t};\n\n\t\t\texpect(cfg.bundler.getExclusions(pkg)).toEqual(['test/**/*']);\n\t\t});\n\n\t\t// Impossible to test once we test for default exclusions\n\t\tit('returns an empty array for unconfigured packages', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(__dirname, '__fixtures__', 'config', 'empty')\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\tconst pkg = {\n\t\t\t\tid: 'not-existent-package@1.0.0',\n\t\t\t\tname: 'not-existent-package',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t};\n\n\t\t\texpect(cfg.bundler.getExclusions(pkg)).toEqual([]);\n\t\t});\n\t});\n\n\tdescribe('getPlugins()', () => {\n\t\tit('loads default \"pre\" plugins correctly', () => {\n\t\t\tconst plugins = cfg.bundler.getPlugins('pre', {\n\t\t\t\tid: 'package-star@1.0.0',\n\t\t\t\tname: 'package-star',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\n\t\t\texpect(plugins[0].run({}, {})).toEqual(0);\n\t\t\texpect(plugins[0].config).toEqual({});\n\n\t\t\texpect(plugins[1].run({}, {})).toEqual(1);\n\t\t\texpect(plugins[1].config).toEqual('config-1');\n\t\t});\n\n\t\tit('loads default \"post\" plugins correctly', () => {\n\t\t\tconst plugins = cfg.bundler.getPlugins('post', {\n\t\t\t\tid: 'package-star@1.0.0',\n\t\t\t\tname: 'package-star',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\n\t\t\texpect(plugins[0].run({}, {})).toEqual(2);\n\t\t\texpect(plugins[0].config).toEqual({});\n\n\t\t\texpect(plugins[1].run({}, {})).toEqual(3);\n\t\t\texpect(plugins[1].config).toEqual('config-3');\n\t\t});\n\n\t\tit('loads per-package \"pre\" plugins correctly', () => {\n\t\t\tconst plugins = cfg.bundler.getPlugins('pre', {\n\t\t\t\tid: 'package@1.0.0',\n\t\t\t\tname: 'package',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\n\t\t\texpect(plugins[0].run({}, {})).toEqual(4);\n\t\t\texpect(plugins[0].config).toEqual({});\n\n\t\t\texpect(plugins[1].run({}, {})).toEqual(5);\n\t\t\texpect(plugins[1].config).toEqual('config-5');\n\t\t});\n\n\t\tit('loads per-package \"post\" plugins correctly', () => {\n\t\t\tconst plugins = cfg.bundler.getPlugins('post', {\n\t\t\t\tid: 'package@1.0.0',\n\t\t\t\tname: 'package',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\n\t\t\texpect(plugins[0].run({}, {})).toEqual(6);\n\t\t\texpect(plugins[0].config).toEqual({});\n\n\t\t\texpect(plugins[1].run({}, {})).toEqual(7);\n\t\t\texpect(plugins[1].config).toEqual('config-7');\n\t\t});\n\n\t\tit('supports legacy package configurations correctly', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(\n\t\t\t\t\t__dirname,\n\t\t\t\t\t'__fixtures__',\n\t\t\t\t\t'config',\n\t\t\t\t\t'legacy-packages'\n\t\t\t\t)\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\tlet plugins = cfg.bundler.getPlugins('pre', {\n\t\t\t\tid: 'package@1.0.0',\n\t\t\t\tname: 'package',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\t\t\texpect(plugins[0].run({}, {})).toEqual(1);\n\n\t\t\tplugins = cfg.bundler.getPlugins('pre', {\n\t\t\t\tid: 'package2@1.0.0',\n\t\t\t\tname: 'package2',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\t\t\texpect(plugins[0].run({}, {})).toEqual(2);\n\n\t\t\tplugins = cfg.bundler.getPlugins('pre', {\n\t\t\t\tid: 'package3@1.0.0',\n\t\t\t\tname: 'package3',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\t\t\texpect(plugins[0].run({}, {})).toEqual(4);\n\n\t\t\tplugins = cfg.bundler.getPlugins('pre', {\n\t\t\t\tid: 'unconfigured-package@1.0.0',\n\t\t\t\tname: 'unconfigured-package',\n\t\t\t\tversion: '1.0.0',\n\t\t\t\tdir: '',\n\t\t\t});\n\t\t\texpect(plugins[0].run({}, {})).toEqual(0);\n\t\t});\n\t});\n});\n\ndescribe('jar config', () => {\n\tdescribe('getOutputDir()', () => {\n\t\tit('works when specified in .npmbundlerrc', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(__dirname, '__fixtures__', 'config', 'create-jar')\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\texpect(cfg.jar.getOutputDir()).toEqual('dist');\n\t\t});\n\n\t\tit('works when not set', () => {\n\t\t\texpect(cfg.jar.getOutputDir()).toEqual(cfg.getOutputDir());\n\t\t});\n\t});\n\n\tdescribe('getWebContextPath()', () => {\n\t\tit('works when specified in .npmbundlerrc', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(__dirname, '__fixtures__', 'config', 'create-jar')\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\texpect(cfg.jar.getWebContextPath()).toEqual('/my-portlet');\n\t\t});\n\n\t\tit('works when not set', () => {\n\t\t\texpect(cfg.jar.getWebContextPath()).toEqual('/default-1.0.0');\n\t\t});\n\t});\n\n\tdescribe('getRequireJsExtender()', () => {\n\t\tit('returns true when create-jar config present and features/js-extender missing', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(\n\t\t\t\t\t__dirname,\n\t\t\t\t\t'__fixtures__',\n\t\t\t\t\t'config',\n\t\t\t\t\t'create-jar-empty'\n\t\t\t\t)\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\texpect(cfg.jar.getRequireJsExtender()).toBe(true);\n\t\t});\n\n\t\tit('returns false when create-jar config present and features/js-extender false', () => {\n\t\t\tprocess.chdir(\n\t\t\t\tpath.join(__dirname, '__fixtures__', 'config', 'create-jar')\n\t\t\t);\n\t\t\tcfg.reloadConfig();\n\n\t\t\texpect(cfg.jar.getRequireJsExtender()).toBe(false);\n\t\t});\n\t});\n});\n\ndescribe('presets', () => {\n\tit('should work with existing presets', () => {\n\t\tprocess.chdir(\n\t\t\tpath.join(__dirname, '__fixtures__', 'config', 'presets')\n\t\t);\n\t\tcfg.reloadConfig();\n\n\t\tconst globalCfg = cfg.getGlobalConfig();\n\n\t\texpect(globalCfg.imports).toBeDefined();\n\n\t\tconst expectedImports = [\n\t\t\t'an-osgi-module',\n\t\t\t'frontend-js-metal-web',\n\t\t\t'frontend-js-node-shims',\n\t\t\t'frontend-js-spa-web',\n\t\t\t'frontend-taglib',\n\t\t\t'frontend-taglib-clay',\n\t\t];\n\n\t\texpectedImports.map(v => {\n\t\t\texpect(globalCfg.imports[v]).toBeDefined();\n\t\t});\n\n\t\tconst anOsgiModuleImports = {\n\t\t\td3: '>=3.0.0',\n\t\t\treact: '>=16.8.5',\n\t\t};\n\n\t\texpect(globalCfg.imports['an-osgi-module']).toMatchObject(\n\t\t\tanOsgiModuleImports\n\t\t);\n\n\t\tconst frontendJsWebImports = {\n\t\t\t'/': '>=8.0.0',\n\t\t};\n\n\t\texpect(globalCfg.imports['frontend-js-web']).toMatchObject(\n\t\t\tfrontendJsWebImports\n\t\t);\n\n\t\tconst frontendJsNodeShimsImports = {\n\t\t\tassert: '>=1.2.0',\n\t\t\tbuffer: '>=5.0.7',\n\t\t\t'console-browserify': '>=1.1.0',\n\t\t\t'domain-browser': '>=1.1.7',\n\t\t\tevents: '>=1.1.1',\n\t\t\t'os-browserify': '>=0.3.0',\n\t\t\t'path-browserify': '>=0.0.0',\n\t\t\tprocess: '>=0.11.10',\n\t\t\tpunycode: '>=1.3.1',\n\t\t\t'querystring-es3': '>=0.2.1',\n\t\t\tsetimmediate: '>=1.0.0',\n\t\t\tstring_decoder: '>=1.0.3',\n\t\t\t'timers-browserify': '>=2.0.4',\n\t\t\t'tty-browserify': '>=0.0.0',\n\t\t\turl: '>=0.11.0',\n\t\t\tutil: '>=0.10.3',\n\t\t\t'vm-browserify': '>=0.0.4',\n\t\t};\n\n\t\texpect(globalCfg.imports['frontend-js-node-shims']).toMatchObject(\n\t\t\tfrontendJsNodeShimsImports\n\t\t);\n\n\t\texpect(cfg.isDumpReport()).toBeTruthy();\n\t});\n});\n"]}