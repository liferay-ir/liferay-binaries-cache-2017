'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.init = init;
exports.configRequire = configRequire;
exports.getPackageConfig = getPackageConfig;

var _resolve = require('resolve');

var _resolve2 = _interopRequireDefault(_resolve);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var config = void 0;

/**
 * Initialize submodule
 * @param {object} state
 * @return {void}
 */
/**
 * Â© 2017 Liferay, Inc. <https://liferay.com>
 *
 * SPDX-License-Identifier: LGPL-3.0-or-later
 */

function init(state) {
	config = state.config;
}

/**
 * Require a module using the configured plugins directory.
 * @param {String} module a module name
 * @return {Object} the required module object
 */
function configRequire(module) {
	var pluginFile = _resolve2.default.sync(module, {
		basedir: config.pluginsBaseDir
	});

	return require(pluginFile);
}

/**
 * Get a configuration for a specific package. This method looks in the packages
 * section, then at root in the precedence order: first package id, then package
 * name.
 * @param {PkgDesc} pkg the package descriptor
 * @param  {String} section the section name (like 'plugins', '.babelrc', ...)
 * @param  {Object} defaultValue default value if not configured
 * @return {Object} a configuration object
 */
function getPackageConfig(pkg, section) {
	var defaultValue = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;

	var pkgConfig = void 0;

	if (config.packages[pkg.id] && config.packages[pkg.id][section]) {
		pkgConfig = config.packages[pkg.id][section];
	} else if (config.packages[pkg.name] && config.packages[pkg.name][section]) {
		pkgConfig = config.packages[pkg.name][section];
	} else if (config[pkg.id] && config[pkg.id][section]) {
		pkgConfig = config[pkg.id][section];
	} else if (config[pkg.name] && config[pkg.name][section]) {
		pkgConfig = config[pkg.name][section];
	} else if (config['*'] && config['*'][section]) {
		pkgConfig = config['*'][section];
	} else {
		pkgConfig = defaultValue;
	}

	return pkgConfig;
}
//# sourceMappingURL=util.js.map