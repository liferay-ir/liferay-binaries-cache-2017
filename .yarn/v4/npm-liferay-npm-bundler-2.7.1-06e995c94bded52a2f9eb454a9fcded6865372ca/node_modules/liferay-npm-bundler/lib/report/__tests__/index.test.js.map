{"version":3,"sources":["../../../src/report/__tests__/index.test.js"],"names":["report","beforeEach","_executionDate","Date","describe","afterEach","expect","toMatchSnapshot","it","executionTime","warn","unique","versionsInfo","rootPackage","id","name","version","dependencies","pkg","linkedDependency","packageCopy","packageProcessBundlerPlugin","config","cfgval1","cfgval2","run","packageProcessBabelConfig","packageProcessBabelRun","toHtml"],"mappings":"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","file":"index.test.js","sourcesContent":["/**\n * Â© 2017 Liferay, Inc. <https://liferay.com>\n *\n * SPDX-License-Identifier: LGPL-3.0-or-later\n */\n\nimport PluginLogger from 'liferay-npm-build-tools-common/lib/plugin-logger';\nimport {Report} from '../index';\n\nlet report;\n\nbeforeEach(() => {\n\treport = new Report();\n\n\t// Hack to make tests repeatable\n\treport._executionDate = new Date(0);\n});\n\ndescribe('when describing the run', () => {\n\tafterEach(() => {\n\t\texpect(report).toMatchSnapshot();\n\t});\n\n\tit('correctly stores executionTime', () => {\n\t\treport.executionTime([1, 2]);\n\t});\n\n\tit('correctly stores warnings', () => {\n\t\treport.warn('warn 1');\n\t\treport.warn('warn 2');\n\t});\n\n\tit('correctly stores unique warnings', () => {\n\t\treport.warn('warn', {unique: true});\n\t\treport.warn('warn', {unique: true});\n\t});\n\n\tit('correctly stores versions info', () => {\n\t\treport.versionsInfo({\n\t\t\t'liferay-npm-bundler': '1.4.2',\n\t\t\t'liferay-npm-bundler-plugin-inject-angular': '1.4.2',\n\t\t});\n\t});\n\n\tit('correctly stores root package description', () => {\n\t\treport.rootPackage({\n\t\t\tid: 'root-package1@1.0.0',\n\t\t\tname: 'root-package',\n\t\t\tversion: '1.0.0',\n\t\t});\n\t});\n\n\tit('correctly stores dependencies', () => {\n\t\treport.dependencies([\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t{id: 'package-2@2.0.0', name: 'package-2', version: '2.0.0'},\n\t\t]);\n\t});\n\n\tit('correctly stores linked dependencies', () => {\n\t\tconst pkg = {\n\t\t\tid: 'a-package@1.1.0',\n\t\t\tname: 'a-package',\n\t\t\tversion: '1.1.0',\n\t\t};\n\t\treport.dependencies([pkg]);\n\t\treport.linkedDependency(pkg.name, 'file:../a-package', pkg.version);\n\t});\n\n\tit('ignores not previously registered linked dependencies', () => {\n\t\treport.linkedDependency('a-package', 'file:../a-package', '1.1.0');\n\t\treport.linkedDependency('package-1', 'file:../package-1', '1.0.0');\n\t});\n\n\tit('correctly stores package copies', () => {\n\t\treport.packageCopy(\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t['a.js', 'b.js', 'c.js'],\n\t\t\t['a.js', 'c.js']\n\t\t);\n\t});\n\n\tit('correctly stores bundler plugin runs', () => {\n\t\treport.packageProcessBundlerPlugin(\n\t\t\t'pre',\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t{\n\t\t\t\tname: 'a-plugin',\n\t\t\t\tconfig: {cfgval1: 1, cfgval2: 2},\n\t\t\t\trun: () => '',\n\t\t\t},\n\t\t\tnew PluginLogger()\n\t\t);\n\t});\n\n\tit('correctly stores Babel config', () => {\n\t\treport.packageProcessBabelConfig(\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t{cfgval1: 1, cfgval2: 2}\n\t\t);\n\t});\n\n\tit('correctly stores Babel file run', () => {\n\t\treport.packageProcessBabelRun(\n\t\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t\t'a.js',\n\t\t\tnew PluginLogger()\n\t\t);\n\t});\n});\n\nit('correctly dumps HTML report', () => {\n\t// The goal of this test is to detect unwanted changes in HTML. If you make\n\t// changes to the HTML on purpose, just check it visually and update the\n\t// snapshot with Jest's -u switch.\n\n\treport.executionTime([1, 2]);\n\treport.warn('warn 1');\n\treport.warn('warn 2');\n\treport.warn('warn', {unique: true});\n\treport.warn('warn', {unique: true});\n\treport.versionsInfo({\n\t\t'liferay-npm-bundler': '1.4.2',\n\t\t'liferay-npm-bundler-plugin-inject-angular': '1.4.2',\n\t});\n\treport.rootPackage({\n\t\tid: 'root-package1@1.0.0',\n\t\tname: 'root-package',\n\t\tversion: '1.0.0',\n\t});\n\treport.dependencies([\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t{id: 'package-2@2.0.0', name: 'package-2', version: '2.0.0'},\n\t]);\n\treport.linkedDependency('a-package', 'file:../a-package', '1.1.0');\n\treport.linkedDependency('package-1', 'file:../package-1', '1.0.0');\n\treport.packageCopy(\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t['a.js', 'b.js', 'c.js'],\n\t\t['a.js', 'c.js']\n\t);\n\treport.packageProcessBundlerPlugin(\n\t\t'pre',\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t{\n\t\t\tname: 'a-plugin',\n\t\t\tconfig: {cfgval1: 1, cfgval2: 2},\n\t\t\trun: () => '',\n\t\t},\n\t\tnew PluginLogger()\n\t);\n\treport.packageProcessBabelConfig(\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t{cfgval1: 1, cfgval2: 2}\n\t);\n\treport.packageProcessBabelRun(\n\t\t{id: 'package-1@1.0.0', name: 'package-1', version: '1.0.0'},\n\t\t'a.js',\n\t\tnew PluginLogger()\n\t);\n\n\texpect(report.toHtml()).toMatchSnapshot();\n});\n"]}