define(["exports","metal/src/metal","./domData","./DomDelegatedEventHandle","./DomEventHandle"],function(e,t,n,r,i){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,n){if((0,t.isObject)(e)&&(0,t.isString)(n)){e.length||(e=[e]);for(var r=0;r<e.length;r++)"classList"in e[r]?s(e[r],n):l(e[r],n)}}function s(e,t){t.split(" ").forEach(function(t){t&&e.classList.add(t)})}function l(e,t){var n=" "+e.className+" ",r="";t=t.split(" ");for(var i=0;i<t.length;i++){var o=t[i];n.indexOf(" "+o+" ")===-1&&(r+=" "+o)}r&&(e.className=e.className+r)}function c(e,t,n){d(Z["default"].get(e,"listeners",{}),t,n)}function u(e,t,n,r){var i=Z["default"].get(e,"delegating",{});d(i[t].selectors,n,r)}function d(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}function f(e,t){var n=Z["default"].get(e,"delegating",{});n[t]||(n[t]={handle:I(e,t,S,!!oe[t]),selectors:{}})}function m(e,t){for(;e&&!D(e,t);)e=e.parentNode;return e}function p(e,n){if((0,t.isString)(n)&&(n=g(n)),n instanceof NodeList)for(var r=Array.prototype.slice.call(n),i=0;i<r.length;i++)e.appendChild(r[i]);else e.appendChild(n);return n}function g(e){var t=document.createElement("div");t.innerHTML="<br>"+e,t.removeChild(t.firstChild);for(var n=document.createDocumentFragment();t.firstChild;)n.appendChild(t.firstChild);return n}function v(e,n){return(0,t.isDocument)(e)?e.documentElement.contains(n):e.contains(n)}function h(e,n,r,i,o){var a=re[n];return a&&a.delegate&&(n=a.originalEvent,i=a.handler.bind(a,i)),o&&(i=i.bind(),i.defaultListener_=!0),f(e,n),(0,t.isString)(r)?u(e,n,r,i):c(r,n,i),new $["default"]((0,t.isString)(r)?e:r,n,i,(0,t.isString)(r)?r:null)}function E(e,t,n){if(n&&"click"===t&&2===n.button)return!1;var r=["BUTTON","INPUT","SELECT","TEXTAREA","FIELDSET"];return!("click"===t&&r.indexOf(e.tagName)>-1)||!(e.disabled||P(e,"fieldset[disabled]"))}function N(e){e&&p(document.body,e)}function b(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function S(e){x(e);var t=!0,n=e.currentTarget,r=[];return t&=R(n,e,r),t&=z(r,e),e.delegateTarget=null,e[ie]=n,t}function y(e,t){return"classList"in e?C(e,t):L(e,t)}function C(e,t){return e.classList.contains(t)}function L(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>=0}function T(e){return 0===e.childNodes.length}function D(e,t){if(!e||1!==e.nodeType)return!1;var n=Element.prototype,r=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return r?r.call(e,t):O(e,t)}function O(e,t){for(var n=document.querySelectorAll(t,e.parentNode),r=0;r<n.length;++r)if(n[r]===e)return!0;return!1}function _(e,t){do if(e=e.nextSibling,e&&D(e,t))return e;while(e);return null}function x(e){e.stopPropagation=q,e.stopImmediatePropagation=B}function I(e,n,r,i){if((0,t.isString)(e))return h(document,n,e,r);var o=re[n];return o&&o.event&&(n=o.originalEvent,r=o.handler.bind(o,r)),e.addEventListener(n,r,i),new ee["default"](e,n,r,i)}function M(e,t,n){var r=I(e,t,function(){return r.removeListener(),n.apply(this,arguments)});return r}function P(e,t){return m(e.parentNode,t)}function j(e,t){re[e]=t}function w(e){for(var t=void 0;t=e.firstChild;)e.removeChild(t)}function k(e,n){if((0,t.isObject)(e)&&(0,t.isString)(n)){e.length||(e=[e]);for(var r=0;r<e.length;r++)"classList"in e[r]?A(e[r],n):F(e[r],n)}}function A(e,t){t.split(" ").forEach(function(t){t&&e.classList.remove(t)})}function F(e,t){var n=" "+e.className+" ";t=t.split(" ");for(var r=0;r<t.length;r++)n=n.replace(" "+t[r]+" "," ");e.className=n.trim()}function H(e,t){e&&t&&e!==t&&e.parentNode&&(e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e))}function B(){var e=this;e.stopped=!0,e.stoppedImmediate=!0,Event.prototype.stopImmediatePropagation.call(e)}function q(){var e=this;e.stopped=!0,Event.prototype.stopPropagation.call(e)}function U(e,n){if(re[n])return!0;(0,t.isString)(e)&&(te[e]||(te[e]=document.createElement(e)),e=te[e]);var r=e.tagName;return ne[r]&&ne[r].hasOwnProperty(n)||(ne[r]=ne[r]||{},ne[r][n]="on"+n in e),ne[r][n]}function z(e,t){for(var n=!0,r=0;r<e.length&&!t.defaultPrevented;r++)t.delegateTarget=e[r].element,n&=e[r].fn(t);return n}function R(e,t,n){for(var r=!0,i=t.target,o=e.parentNode;i&&i!==o&&!t.stopped;)E(i,t.type,t)&&(t.delegateTarget=i,r&=Q(i,t,n),r&=Y(e,i,t,n)),i=i.parentNode;return r}function X(e){return(0,t.isElement)(e)||(0,t.isDocument)(e)||(0,t.isDocumentFragment)(e)?e:(0,t.isString)(e)?"#"===e[0]&&e.indexOf(" ")===-1?document.getElementById(e.substr(1)):document.querySelector(e):null}function G(e,n){(0,t.isObject)(e)&&(0,t.isString)(n)&&("classList"in e?J(e,n):K(e,n))}function J(e,t){t.split(" ").forEach(function(t){e.classList.toggle(t)})}function K(e,t){var n=" "+e.className+" ";t=t.split(" ");for(var r=0;r<t.length;r++){var i=" "+t[r]+" ",o=n.indexOf(i);if(o===-1)n=""+n+t[r]+" ";else{var a=n.substring(0,o),s=n.substring(o+i.length);n=a+" "+s}}e.className=n.trim()}function Q(e,n,r){var i=n[ie];if(!(0,t.isDef)(i)||!v(i,e)){var o=Z["default"].get(e,"listeners",{})[n.type];return W(o,n,e,r)}return!0}function V(e,n,r){if(E(e,n,r)){var i=document.createEvent("HTMLEvents");i.initEvent(n,!0,!0),t.object.mixin(i,r),e.dispatchEvent(i)}}function W(e,t,n,r){var i=!0;e=e||[];for(var o=0;o<e.length&&!t.stoppedImmediate;o++)e[o].defaultListener_?r.push({element:n,fn:e[o]}):i&=e[o](t);return i}function Y(e,t,n,r){for(var i=!0,o=Z["default"].get(e,"delegating",{}),a=o[n.type].selectors,s=Object.keys(a),l=0;l<s.length&&!n.stoppedImmediate;l++)if(D(t,s[l])){var c=a[s[l]];i&=W(c,n,t,r)}return i}Object.defineProperty(e,"__esModule",{value:!0}),e.customEvents=void 0,e.addClasses=a,e.closest=m,e.append=p,e.buildFragment=g,e.contains=v,e.delegate=h,e.enterDocument=N,e.exitDocument=b,e.hasClass=y,e.isEmpty=T,e.match=D,e.next=_,e.on=I,e.once=M,e.parent=P,e.registerCustomEvent=j,e.removeChildren=w,e.removeClasses=k,e.replace=H,e.supportsEvent=U,e.toElement=X,e.toggleClasses=G,e.triggerEvent=V;var Z=o(n),$=o(r),ee=o(i),te={},ne={},re=e.customEvents={},ie="__metal_last_container__",oe={blur:!0,error:!0,focus:!0,invalid:!0,load:!0,scroll:!0}});