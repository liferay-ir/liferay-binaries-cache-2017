define(["exports","./changes","./data","./children/children","./render/patch","./render/render","metal-component/src/all/component","./incremental-dom"],function(e,n,t,r,o,a,i){"use strict";function u(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}function c(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function l(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function s(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}Object.defineProperty(e,"__esModule",{value:!0});var d=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),p=function(e){function p(){return c(this,p),l(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return s(p,e),d(p,[{key:"buildShouldUpdateArgs",value:function(e){return[e.props]}},{key:"dispose",value:function(e){var n=(0,t.getData)(e),r=n.config.ref,o=n.owner;if(o&&o.components&&o.components[r]===e&&delete o.components[r],n.childComponents)for(var a=0;a<n.childComponents.length;a++){var i=n.childComponents[a];i.isDisposed()||(i.element=null,i.dispose())}(0,t.clearData)(e)}},{key:"generateKey",value:function(e,n){return n}},{key:"getConfig",value:function(e){return(0,t.getData)(e).config}},{key:"getData",value:function(e){return(0,t.getData)(e)}},{key:"getPatchingComponent",value:function(){return(0,o.getPatchingComponent)()}},{key:"handleNodeRendered",value:function(){}},{key:"isIncDomNode",value:function(e){return!!(0,r.getOwner)(e)}},{key:"patch",value:function(e){(0,o.patch)(e)}},{key:"render",value:function(e,n,t){return e instanceof i.Component?void this.patch(e):(0,a.renderFunction)(this,e,n,t)}},{key:"renderChild",value:function(e){(0,a.renderChild)(e)}},{key:"renderIncDom",value:function(e){e.render?e.render():IncrementalDOM.elementVoid("div")}},{key:"renderInsidePatch",value:function(e){var t=!e.wasRendered||this.shouldUpdate(e,(0,n.getChanges)(e))||IncrementalDOM.currentPointer()!==e.element;t?(0,a.render)(e):e.element&&this.skipRender()}},{key:"setUp",value:function(e){e.context={},e.components={},e.refs={};var r=(0,t.getData)(e);r.config=e.getInitialConfig(),(0,n.trackChanges)(e)}},{key:"shouldUpdate",value:function(e,n){return!!n&&(!e.shouldUpdate||e.shouldUpdate.apply(e,u(this.buildShouldUpdateArgs(n))))}},{key:"skipNextChildrenDisposal",value:function(e){(0,t.getData)(e).childComponents=null}},{key:"skipRender",value:function(){IncrementalDOM.skipNode()}},{key:"update",value:function(e){this.shouldUpdate(e,(0,n.getChanges)(e))&&this.patch(e)}}]),p}(i.ComponentRenderer.constructor),f=new p;f.RENDERER_NAME="incremental-dom",e["default"]=f});