{"version":3,"sources":["../src/ClayComponent.js"],"names":["ClayComponent","args","element","getAttribute","bind","attributeValue","attributeName","domData","get","core","isDefAndNotNull","dataKey","data","hasOwnProperty","_renderDataAttributes","newVal","prevVal","eventName","originalEvent","getShouldUseFacade","facade","preventDefault","preventedDefault","defaultPrevented","stopInmediatePropagation","stopPropagation","target","type","event","name","buildFacade_","listeners","getRawListeners_","handlerName","charAt","toUpperCase","slice","runListeners_","defaultEventHandler","push","defaultListeners","i","length","listener","fn","default","apply","j","Object","prototype","call","setAttribute","Component","STATE","Config","object"],"mappings":"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","file":"ClayComponent.js","sourcesContent":["import Component from 'metal-component';\nimport {Config} from 'metal-state';\nimport {domData} from 'metal-dom';\nimport {core, isObject, isServerSide} from 'metal';\n\n/**\n * Clay Component.\n * @extends Component\n */\nclass ClayComponent extends Component {\n\t/**\n\t * @inheritDoc\n\t */\n\tattached(...args) {\n\t\tsuper.attached(...args);\n\n\t\tif (isServerSide() || !this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet getAttribute = this.element.getAttribute.bind(this.element);\n\n\t\tthis.element.getAttribute = attributeName => {\n\t\t\tlet attributeValue = getAttribute(attributeName);\n\n\t\t\tif (this.element && !attributeValue) {\n\t\t\t\tattributeValue = domData.get(this.element, attributeName);\n\t\t\t}\n\n\t\t\treturn core.isDefAndNotNull(attributeValue) ? attributeValue : '';\n\t\t};\n\n\t\tfor (let dataKey in this.data) {\n\t\t\tif (this.data.hasOwnProperty(dataKey)) {\n\t\t\t\tdomData.get(\n\t\t\t\t\tthis.element,\n\t\t\t\t\t'data-' + dataKey,\n\t\t\t\t\tthis.data[dataKey]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\trendered(...args) {\n\t\tsuper.rendered(...args);\n\n\t\tthis._renderDataAttributes();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tsyncData(newVal, prevVal) {\n\t\tif (newVal != prevVal) {\n\t\t\tthis._renderDataAttributes();\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tbuildFacade_(eventName, data, originalEvent) {\n\t\tif (this.getShouldUseFacade()) {\n\t\t\tconst facade = {\n\t\t\t\tdata: data,\n\t\t\t\tpreventDefault: function() {\n\t\t\t\t\tfacade.preventedDefault = true;\n\t\t\t\t\tif (\n\t\t\t\t\t\toriginalEvent &&\n\t\t\t\t\t\toriginalEvent.preventDefault &&\n\t\t\t\t\t\t(!originalEvent.preventDefault ||\n\t\t\t\t\t\t\t!originalEvent.defaultPrevented)\n\t\t\t\t\t) {\n\t\t\t\t\t\toriginalEvent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tstopInmediatePropagation: function() {\n\t\t\t\t\tif (\n\t\t\t\t\t\toriginalEvent &&\n\t\t\t\t\t\toriginalEvent.stopInmediatePropagation\n\t\t\t\t\t) {\n\t\t\t\t\t\toriginalEvent.stopInmediatePropagation();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tstopPropagation: function() {\n\t\t\t\t\tif (originalEvent && originalEvent.stopPropagation) {\n\t\t\t\t\t\toriginalEvent.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttarget: this,\n\t\t\t\ttype: eventName,\n\t\t\t};\n\n\t\t\treturn facade;\n\t\t}\n\t}\n\n\t/**\n\t * Execute each of the listeners in order with te supplied arguments.\n\t * @param {string|object} event\n\t * @param {*} opt_args [arg1], [arg2], [...]\n\t * @return {boolean} Returns true if event had listeners, false otherwise.\n\t */\n\temit(event, ...args) {\n\t\tconst eventName = isObject(event) ? event.name : event;\n\t\tconst facade = this.buildFacade_(\n\t\t\teventName,\n\t\t\tevent.data,\n\t\t\tevent.originalEvent\n\t\t);\n\n\t\targs = isObject(event) ? [facade] : args;\n\n\t\tconst listeners = this.getRawListeners_(eventName);\n\n\t\tconst handlerName =\n\t\t\t'handle' + eventName.charAt(0).toUpperCase() + eventName.slice(1);\n\n\t\tthis.runListeners_(\n\t\t\tlisteners,\n\t\t\targs,\n\t\t\tfacade,\n\t\t\tthis.defaultEventHandler,\n\t\t\thandlerName\n\t\t);\n\t\treturn true;\n\t}\n\n\t/**\n\t * Runs the given listeners.\n\t * @param {!Array} listeners\n\t * @param {!Array} args\n\t * @param {Object} facade\n\t * @param {Object} defaultEventHandler\n\t * @param {String} handlerName\n\t * @protected\n\t */\n\trunListeners_(listeners, args, facade, defaultEventHandler, handlerName) {\n\t\tif (facade) {\n\t\t\targs.push(facade);\n\t\t}\n\n\t\tconst defaultListeners = [];\n\t\tfor (let i = 0; i < listeners.length; i++) {\n\t\t\tconst listener = listeners[i].fn || listeners[i];\n\t\t\tif (listeners[i].default) {\n\t\t\t\tdefaultListeners.push(listener);\n\t\t\t} else {\n\t\t\t\tlistener.apply(this, args);\n\t\t\t}\n\t\t}\n\n\t\tdefaultEventHandler &&\n\t\t\tdefaultEventHandler[handlerName] &&\n\t\t\tdefaultEventHandler[handlerName](...args);\n\n\t\tif (!facade || !facade.preventedDefault) {\n\t\t\tfor (let j = 0; j < defaultListeners.length; j++) {\n\t\t\t\tdefaultListeners[j].apply(this, args);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Places the data attributes in the dom.\n\t */\n\t_renderDataAttributes() {\n\t\tfor (let dataKey in this.data) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.data, dataKey)) {\n\t\t\t\tthis.element.setAttribute(\n\t\t\t\t\t'data-' + dataKey,\n\t\t\t\t\tthis.data[dataKey]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * State definition.\n * @static\n * @type {!Object}\n */\nClayComponent.STATE = {\n\t/**\n\t * Data to add to the element.\n\t * @default undefined\n\t * @instance\n\t * @memberof ClayComponent\n\t * @type {?object}\n\t */\n\tdata: Config.object(),\n\n\t/**\n\t * Object that wires events with default listeners\n\t * @default undefined\n\t * @instance\n\t * @memberof ClayComponent\n\t * @review\n\t * @type {?(object|undefined)}\n\t */\n\tdefaultEventHandler: Config.object(),\n};\n\nexport {ClayComponent};\nexport default ClayComponent;\n"]}